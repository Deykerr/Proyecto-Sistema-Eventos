<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Próximos Eventos</h2>

    <div class="d-flex gap-2">
      <select class="form-select" style="width: 200px;" [(ngModel)]="selectedCategory" (change)="filterEvents()">
        <option value="">Todas las Categorías</option>
        <option *ngFor="let cat of categories" [value]="cat.id">{{ cat.name }}</option>
      </select>

      <button class="btn btn-success" 
          routerLink="/events/create"
          *ngIf="authService.getUserRole() === 'Organizer' || authService.getUserRole() === 'Admin'">
    <i class="bi bi-plus-lg"></i> Crear
  </button>
    </div>
  </div>

  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>

  <div *ngIf="!isLoading && events.length === 0" class="alert alert-info text-center">
    No hay eventos disponibles en este momento.
  </div>

  <div class="row row-cols-1 row-cols-md-3 g-4" *ngIf="!isLoading && events.length > 0">
    <div class="col" *ngFor="let event of events">
      <div class="card h-100 shadow-sm hover-effect">
        <div class="bg-secondary text-white d-flex align-items-center justify-content-center" style="height: 150px;">
          <i class="bi bi-image fs-1"></i>
        </div>

        <div class="card-body">
          <div class="d-flex justify-content-between mb-2">
            <span class="badge bg-info text-dark">{{ event.categoryName }}</span>
            <span class="text-success fw-bold">{{ event.price | currency:'PEN':'S/ ' }}</span>
          </div>

          <h5 class="card-title fw-bold text-truncate">{{ event.title }}</h5>
          <p class="card-text text-muted small text-truncate">{{ event.description }}</p>

          <div class="mb-2 small">
            <i class="bi bi-calendar3 me-1"></i> {{ event.startDate | date:'shortDate' }}
          </div>
          <div class="small">
            <i class="bi bi-geo-alt-fill me-1"></i> {{ event.location }}
          </div>
        </div>

        <div class="card-footer bg-white border-top-0 d-grid">
          <button class="btn btn-outline-primary btn-sm" [routerLink]="['/events', event.id]">
            Ver Detalles
          </button>
        </div>
      </div>
    </div>
  </div>
</div>